(function(){"use strict";var e={8223:function(e,t,i){var r=i(5130),o=i(6768);const a={id:"app"};function n(e,t){const i=(0,o.g2)("router-view");return(0,o.uX)(),(0,o.CE)("div",a,[(0,o.bF)(i)])}var s=i(1241);const d={},c=(0,s.A)(d,[["render",n]]);var l=c,u=i(1387);const p={class:"product-list-page"},h={class:"search-bar"},m={key:0,class:"product-grid"},f={key:1,class:"no-products-found"},g={key:2,ref:"scrollTrigger",class:"scroll-trigger"},k={key:3,class:"end-of-list"},P={key:4,class:"loading-initial"};function b(e,t,i,a,n,s){const d=(0,o.g2)("ProductCard");return(0,o.uX)(),(0,o.CE)("div",p,[t[2]||(t[2]=(0,o.Lk)("header",{class:"app-header"},[(0,o.Lk)("h1",null,"Petra's Store")],-1)),(0,o.Lk)("div",h,[(0,o.bo)((0,o.Lk)("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>n.searchTerm=e),placeholder:"Cari produk...",class:"search-input"},null,512),[[r.Jo,n.searchTerm]])]),n.displayedProducts.length>0?((0,o.uX)(),(0,o.CE)("div",m,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(n.displayedProducts,e=>((0,o.uX)(),(0,o.Wv)(d,{key:e.id,product:e},null,8,["product"]))),128))])):((0,o.uX)(),(0,o.CE)("p",f,"Tidak ada produk ditemukan.")),n.hasMoreProducts?((0,o.uX)(),(0,o.CE)("div",g,t[1]||(t[1]=[(0,o.Lk)("p",null,"Memuat lebih banyak produk...",-1),(0,o.Lk)("div",{class:"spinner"},null,-1)]),512)):!n.isLoading&&n.allProducts.length>0&&!n.hasMoreProducts?((0,o.uX)(),(0,o.CE)("p",k," Anda telah mencapai akhir daftar produk. ")):n.isLoading?((0,o.uX)(),(0,o.CE)("p",P,"Memuat produk awal...")):(0,o.Q3)("",!0)])}i(8111),i(2489);var L=i(4232);const v={class:"product-card"},w=["href"],y={class:"product-id-badge"},C={key:0,class:"product-image-container"},E=["src","alt"],I={key:0,class:"image-loading-placeholder"},M={class:"product-info"},U={class:"product-name"},O={class:"product-description"};function T(e,t,i,r,a,n){return(0,o.uX)(),(0,o.CE)("div",v,[(0,o.Lk)("a",{href:i.product.affiliateLink,target:"_blank",rel:"noopener noreferrer"},[(0,o.Lk)("div",y,(0,L.v_)(i.product.id),1),i.product.imageUrl?((0,o.uX)(),(0,o.CE)("div",C,[(0,o.Lk)("img",{src:i.product.imageUrl,alt:i.product.name,class:"product-image"},null,8,E),a.isImageLoaded?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("div",I,t[0]||(t[0]=[(0,o.Lk)("div",{class:"mini-spinner"},null,-1)])))])):(0,o.Q3)("",!0),(0,o.Lk)("div",M,[(0,o.Lk)("h3",U,(0,L.v_)(i.product.name),1),(0,o.Lk)("p",O,(0,L.v_)(i.product.description),1),t[1]||(t[1]=(0,o.Lk)("button",{class:"buy-button"},"Beli Sekarang",-1))])],8,w)])}i(7588);var D={name:"ProductCard",props:{product:{type:Object,required:!0}},data(){return{isImageLoaded:!1,observer:null}},mounted(){this.$nextTick(()=>{this.product.imageUrl?this.setupImageIntersectionObserver():this.isImageLoaded=!0})},beforeUnmount(){this.observer&&this.observer.disconnect()},methods:{setupImageIntersectionObserver(){this.observer=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&(this.isImageLoaded=!0,this.observer.unobserve(e.target))})},{root:null,rootMargin:"100px",threshold:0});const e=this.$el.querySelector(".product-image-container");e&&this.observer.observe(e)}}};const _=(0,s.A)(D,[["render",T],["__scopeId","data-v-6f17476a"]]);var X=_;const A=6;var j={name:"ProductList",components:{ProductCard:X},data(){return{allProducts:[],displayedProducts:[],searchTerm:"",currentPage:0,isLoading:!1,hasMoreProducts:!0,observer:null}},computed:{filteredProducts(){if(!this.searchTerm)return this.allProducts;const e=this.searchTerm.toLowerCase();return this.allProducts.filter(t=>t.name.toLowerCase().includes(e)||t.description.toLowerCase().includes(e))}},watch:{searchTerm(){this.resetAndLoadInitialProducts()}},mounted(){this.fetchAllProducts(),this.setupIntersectionObserver()},beforeUnmount(){this.observer&&this.observer.disconnect()},methods:{async fetchAllProducts(){this.isLoading=!0;try{const e=await fetch("/products.json");if(!e.ok)throw new Error("Failed to fetch products");this.allProducts=await e.json(),this.resetAndLoadInitialProducts()}catch(e){console.error("Error fetching products:",e),this.isLoading=!1}},loadMoreProducts(){!this.isLoading&&this.hasMoreProducts&&(this.isLoading=!0,setTimeout(()=>{const e=this.currentPage*A,t=e+A,i=this.filteredProducts.slice(e,t);i.length>0?(this.displayedProducts=[...this.displayedProducts,...i],this.currentPage++,this.displayedProducts.length>=this.filteredProducts.length&&(this.hasMoreProducts=!1)):this.hasMoreProducts=!1,this.isLoading=!1},500))},resetAndLoadInitialProducts(){this.displayedProducts=[],this.currentPage=0,this.hasMoreProducts=!0,this.isLoading=!1,this.$nextTick(()=>{this.loadMoreProducts()})},setupIntersectionObserver(){this.observer=new IntersectionObserver(e=>{const[t]=e;t.isIntersecting&&this.hasMoreProducts&&!this.isLoading&&this.loadMoreProducts()},{root:null,rootMargin:"0px",threshold:.1}),this.$nextTick(()=>{this.$refs.scrollTrigger&&this.observer.observe(this.$refs.scrollTrigger)})}}};const x=(0,s.A)(j,[["render",b],["__scopeId","data-v-a9ac354c"]]);var S=x;const $={class:"product-management-page"},J={class:"management-header"},q={class:"add-product-section card"},N={class:"product-form"},V={class:"form-group"},F={class:"form-group"},B={class:"form-group"},Q={class:"form-group"},R={class:"product-list-management-section card"},H={key:0},K={key:1,class:"product-management-grid"},G={class:"item-id-badge"},W=["src","alt"],Y={key:1,class:"item-no-image-placeholder"},z={class:"item-info"},Z={class:"item-actions"},ee=["onClick"],te=["onClick"],ie={key:0,class:"modal-overlay"},re={class:"modal-content"},oe={class:"form-group"},ae={class:"form-group"},ne={class:"form-group"},se={class:"form-group"},de={class:"form-group"},ce={class:"modal-actions"},le={key:1,class:"modal-overlay"},ue={class:"modal-content small-modal"},pe={class:"modal-actions"};function he(e,t,i,a,n,s){const d=(0,o.g2)("router-link");return(0,o.uX)(),(0,o.CE)("div",$,[(0,o.Lk)("header",J,[t[16]||(t[16]=(0,o.Lk)("h1",null,"Manajemen Produk",-1)),(0,o.bF)(d,{to:"/",class:"back-to-store"},{default:(0,o.k6)(()=>t[15]||(t[15]=[(0,o.eW)("Kembali ke Toko")])),_:1,__:[15]})]),(0,o.Lk)("div",q,[t[21]||(t[21]=(0,o.Lk)("h2",null,"Tambah Produk Baru",-1)),(0,o.Lk)("form",N,[(0,o.Lk)("div",V,[t[17]||(t[17]=(0,o.Lk)("label",{for:"newAffiliateLink"},"Link Afiliasi:",-1)),(0,o.bo)((0,o.Lk)("input",{type:"url",id:"newAffiliateLink","onUpdate:modelValue":t[0]||(t[0]=e=>n.newProduct.affiliateLink=e),required:""},null,512),[[r.Jo,n.newProduct.affiliateLink]]),(0,o.Lk)("button",{class:"btn btn-primary m-1",onClick:t[1]||(t[1]=(...e)=>s.getLinkPreview&&s.getLinkPreview(...e))},"Get Auto")]),(0,o.Lk)("div",F,[t[18]||(t[18]=(0,o.Lk)("label",{for:"newName"},"Nama Produk:",-1)),(0,o.bo)((0,o.Lk)("input",{type:"text",id:"newName","onUpdate:modelValue":t[2]||(t[2]=e=>n.newProduct.name=e),required:""},null,512),[[r.Jo,n.newProduct.name]])]),(0,o.Lk)("div",B,[t[19]||(t[19]=(0,o.Lk)("label",{for:"newDescription"},"Deskripsi:",-1)),(0,o.bo)((0,o.Lk)("textarea",{id:"newDescription","onUpdate:modelValue":t[3]||(t[3]=e=>n.newProduct.description=e),required:""},null,512),[[r.Jo,n.newProduct.description]])]),(0,o.Lk)("div",Q,[t[20]||(t[20]=(0,o.Lk)("label",{for:"newImageUrl"},"URL Gambar (Opsional):",-1)),(0,o.bo)((0,o.Lk)("input",{type:"url",id:"newImageUrl","onUpdate:modelValue":t[4]||(t[4]=e=>n.newProduct.imageUrl=e)},null,512),[[r.Jo,n.newProduct.imageUrl]])]),(0,o.Lk)("button",{onClick:t[5]||(t[5]=(...e)=>s.addProduct&&s.addProduct(...e)),class:"btn btn-primary"},"Tambah Produk")])]),(0,o.Lk)("div",R,[t[22]||(t[22]=(0,o.Lk)("h2",null,"Daftar Produk",-1)),0!==n.products.length||n.isLoading?((0,o.uX)(),(0,o.CE)("div",K,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(n.products,e=>((0,o.uX)(),(0,o.CE)("div",{key:e.id,class:"product-management-item"},[(0,o.Lk)("div",G,(0,L.v_)(e.id),1),e.imageUrl?((0,o.uX)(),(0,o.CE)("img",{key:0,src:e.imageUrl,alt:e.name,class:"item-image"},null,8,W)):((0,o.uX)(),(0,o.CE)("div",Y,"No Image")),(0,o.Lk)("div",z,[(0,o.Lk)("h3",null,(0,L.v_)(e.name),1),(0,o.Lk)("p",null,(0,L.v_)(e.description),1),(0,o.Lk)("div",Z,[(0,o.Lk)("button",{onClick:t=>s.editProduct(e),class:"btn btn-secondary"},"Edit",8,ee),(0,o.Lk)("button",{onClick:t=>s.confirmDelete(e.id),class:"btn btn-danger"},"Hapus",8,te)])])]))),128))])):((0,o.uX)(),(0,o.CE)("p",H,"Tidak ada produk untuk dikelola."))]),n.showEditModal?((0,o.uX)(),(0,o.CE)("div",ie,[(0,o.Lk)("div",re,[t[29]||(t[29]=(0,o.Lk)("h2",null,"Edit Produk",-1)),(0,o.Lk)("form",{onSubmit:t[12]||(t[12]=(0,r.D$)((...e)=>s.updateProduct&&s.updateProduct(...e),["prevent"])),class:"product-form"},[(0,o.Lk)("div",oe,[t[23]||(t[23]=(0,o.Lk)("label",{for:"editId"},"ID Produk:",-1)),(0,o.bo)((0,o.Lk)("input",{type:"number",id:"editId","onUpdate:modelValue":t[6]||(t[6]=e=>n.editingProduct.id=e),required:"",readonly:""},null,512),[[r.Jo,n.editingProduct.id,void 0,{number:!0}]])]),(0,o.Lk)("div",ae,[t[24]||(t[24]=(0,o.Lk)("label",{for:"editName"},"Nama Produk:",-1)),(0,o.bo)((0,o.Lk)("input",{type:"text",id:"editName","onUpdate:modelValue":t[7]||(t[7]=e=>n.editingProduct.name=e),required:""},null,512),[[r.Jo,n.editingProduct.name]])]),(0,o.Lk)("div",ne,[t[25]||(t[25]=(0,o.Lk)("label",{for:"editDescription"},"Deskripsi:",-1)),(0,o.bo)((0,o.Lk)("textarea",{id:"editDescription","onUpdate:modelValue":t[8]||(t[8]=e=>n.editingProduct.description=e),required:""},null,512),[[r.Jo,n.editingProduct.description]])]),(0,o.Lk)("div",se,[t[26]||(t[26]=(0,o.Lk)("label",{for:"editImageUrl"},"URL Gambar (Opsional):",-1)),(0,o.bo)((0,o.Lk)("input",{type:"url",id:"editImageUrl","onUpdate:modelValue":t[9]||(t[9]=e=>n.editingProduct.imageUrl=e)},null,512),[[r.Jo,n.editingProduct.imageUrl]])]),(0,o.Lk)("div",de,[t[27]||(t[27]=(0,o.Lk)("label",{for:"editAffiliateLink"},"Link Afiliasi:",-1)),(0,o.bo)((0,o.Lk)("input",{type:"url",id:"editAffiliateLink","onUpdate:modelValue":t[10]||(t[10]=e=>n.editingProduct.affiliateLink=e),required:""},null,512),[[r.Jo,n.editingProduct.affiliateLink]])]),(0,o.Lk)("div",ce,[t[28]||(t[28]=(0,o.Lk)("button",{type:"submit",class:"btn btn-primary"},"Simpan Perubahan",-1)),(0,o.Lk)("button",{type:"button",onClick:t[11]||(t[11]=(...e)=>s.cancelEdit&&s.cancelEdit(...e)),class:"btn btn-secondary"},"Batal")])],32)])])):(0,o.Q3)("",!0),n.showConfirmDialog?((0,o.uX)(),(0,o.CE)("div",le,[(0,o.Lk)("div",ue,[t[30]||(t[30]=(0,o.Lk)("h2",null,"Konfirmasi Hapus",-1)),t[31]||(t[31]=(0,o.Lk)("p",null,"Anda yakin ingin menghapus produk ini?",-1)),(0,o.Lk)("div",pe,[(0,o.Lk)("button",{onClick:t[13]||(t[13]=(...e)=>s.deleteProduct&&s.deleteProduct(...e)),class:"btn btn-danger"},"Ya, Hapus"),(0,o.Lk)("button",{onClick:t[14]||(t[14]=(...e)=>s.cancelDelete&&s.cancelDelete(...e)),class:"btn btn-secondary"},"Batal")])])])):(0,o.Q3)("",!0)])}i(4114),i(1701),i(3579);var me=i(4373),fe={name:"ProductManagement",data(){return{products:[],newProduct:{name:"",description:"",imageUrl:"",imageOthers:[],affiliateLink:""},editingProduct:null,showEditModal:!1,showConfirmDialog:!1,productIdToDelete:null,isLoading:!1}},mounted(){this.fetchProducts()},methods:{async getShopeePreviewBrowser(e){const t="https://cors-anywhere.herokuapp.com/",i=await fetch("api/shopee-preview?url="+e,{redirect:"manual"}).then(e=>e.headers.get("location")),r=i.match(/i\.(\d+)\.(\d+)/),o=`${t}https://shopee.co.id/api/v4/item/get?itemid=${r[2]}&shopid=${r[1]}`,a=await fetch(o,{headers:{"X-Requested-With":"XMLHttpRequest",Referer:i}}),n=await a.json();return{name:n.data.name,description:n.data.description,mainImage:`https://cf.shopee.co.id/file/${n.data.image}`,images:n.data.images?.map(e=>`https://cf.shopee.co.id/file/${e}`)}},async getLinkPreview(){const e=this.newProduct.affiliateLink;me.A.get("http://localhost:3000/api/shopee-preview?url="+e).then(e=>{this.newProduct.name=e.data.name,this.newProduct.description=e.data.description,this.newProduct.imageUrl=`https://cf.shopee.co.id/file/${e.data.image}`,this.newProduct.imageOthers=e.data.images?.map(e=>`https://cf.shopee.co.id/file/${e}`)}).catch(e=>{console.error(e)})},async fetchProducts(){this.isLoading=!0;try{const e=await fetch("/products.json");if(!e.ok)throw new Error("Failed to fetch products");this.products=JSON.parse(JSON.stringify(await e.json()))}catch(e){console.error("Error fetching products:",e)}finally{this.isLoading=!1}},addProduct(){this.newProduct.id&&this.newProduct.name&&this.newProduct.description&&this.newProduct.affiliateLink?this.products.some(e=>e.id===this.newProduct.id)?alert("ID Produk sudah ada. Mohon gunakan ID yang berbeda."):(this.products.push({...this.newProduct}),this.resetNewProductForm(),alert("Produk berhasil ditambahkan!")):alert("Mohon lengkapi semua bidang yang wajib diisi.")},editProduct(e){this.editingProduct={...e},this.showEditModal=!0},updateProduct(){if(!this.editingProduct.name||!this.editingProduct.description||!this.editingProduct.affiliateLink)return void alert("Mohon lengkapi semua bidang yang wajib diisi.");const e=this.products.findIndex(e=>e.id===this.editingProduct.id);-1!==e&&(this.products.splice(e,1,{...this.editingProduct}),this.showEditModal=!1,this.editingProduct=null,alert("Produk berhasil diperbarui!"))},confirmDelete(e){this.productIdToDelete=e,this.showConfirmDialog=!0},deleteProduct(){this.products=this.products.filter(e=>e.id!==this.productIdToDelete),this.showConfirmDialog=!1,this.productIdToDelete=null,alert("Produk berhasil dihapus!")},cancelEdit(){this.showEditModal=!1,this.editingProduct=null},cancelDelete(){this.showConfirmDialog=!1,this.productIdToDelete=null},resetNewProductForm(){this.newProduct={name:"",description:"",imageUrl:"",affiliateLink:"",imageOthers:[]}}}};const ge=(0,s.A)(fe,[["render",he],["__scopeId","data-v-47ae6fad"]]);var ke=ge;const Pe=[{path:"/",name:"ProductList",component:S},{path:"/manage-products",name:"ProductManagement",component:ke}],be=(0,u.aE)({history:(0,u.LA)("/"),routes:Pe});var Le=be;Le.afterEach(e=>{document.title=e.meta.title||"Petra's Store"}),(0,r.Ef)(l).use(Le).mount("#app")}},t={};function i(r){var o=t[r];if(void 0!==o)return o.exports;var a=t[r]={exports:{}};return e[r].call(a.exports,a,a.exports,i),a.exports}i.m=e,function(){var e=[];i.O=function(t,r,o,a){if(!r){var n=1/0;for(l=0;l<e.length;l++){r=e[l][0],o=e[l][1],a=e[l][2];for(var s=!0,d=0;d<r.length;d++)(!1&a||n>=a)&&Object.keys(i.O).every(function(e){return i.O[e](r[d])})?r.splice(d--,1):(s=!1,a<n&&(n=a));if(s){e.splice(l--,1);var c=o();void 0!==c&&(t=c)}}return t}a=a||0;for(var l=e.length;l>0&&e[l-1][2]>a;l--)e[l]=e[l-1];e[l]=[r,o,a]}}(),function(){i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,{a:t}),t}}(),function(){i.d=function(e,t){for(var r in t)i.o(t,r)&&!i.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}}(),function(){i.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};i.O.j=function(t){return 0===e[t]};var t=function(t,r){var o,a,n=r[0],s=r[1],d=r[2],c=0;if(n.some(function(t){return 0!==e[t]})){for(o in s)i.o(s,o)&&(i.m[o]=s[o]);if(d)var l=d(i)}for(t&&t(r);c<n.length;c++)a=n[c],i.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return i.O(l)},r=self["webpackChunkmini_ecommerce_affiliate"]=self["webpackChunkmini_ecommerce_affiliate"]||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))}();var r=i.O(void 0,[504],function(){return i(8223)});r=i.O(r)})();
//# sourceMappingURL=app.6a5e0c2e.js.map